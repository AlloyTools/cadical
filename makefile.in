MAKEFLAGS=-j $(if $(CORES),$(CORES),1)
OBJ=$(shell ls *.cpp|sed -e '/main/d' -e 's,.cpp$$,.o,g')
SRC=$(shell ls *.cpp *.hpp|grep -v config.hpp)
COMPILE=@CXX@ @CXXFLAGS@
all: cadical libcadical.a
.cpp.o:
	$(COMPILE) -c $<
-include dependencies
cadical: main.o libcadical.a makefile
	$(COMPILE) -o $@ main.o -L. -lcadical
libcadical.a: $(OBJ) makefile
	ar rc $@ $(OBJ)
	ranlib $@
config.hpp: make-config-header.sh $(SRC) makefile
	./make-config-header.sh > $@
dependencies: config.hpp $(SRC) makefile
	$(COMPILE) -MM $(SRC)|sed -e 's,:,: makefile,' >$@
clean:
	rm -f *.o *.a cadical makefile config.hpp dependencies
	rm -f cnfs/*.log cnfs/*.err cnfs/*.proof cnfs/*.check
